import { isValidConsentCookie } from "./cookie-functions";
let clarityEnabled = false;
export default function initClarity(clarityId, userConsent) {
    // if the environment doesn't have a measurement id, don't load analytics
    clarityEnabled = Boolean(clarityId);
    if (!clarityEnabled)
        return;
    window.clarity = window.clarity || function () {
        (window.clarity.q = window.clarity.q || []).push(arguments);
    };
    let previousConsent = Boolean(window.sessionStorage.getItem('_cltk'));
    if (userConsent && isValidConsentCookie(userConsent) && userConsent.analytics != previousConsent) {
        updateConsent(userConsent.analytics);
    }
    loadClarityScript(clarityId);
}
export function updateConsent(consent) {
    if (!clarityEnabled)
        return;
    window.clarity('consent', consent);
}
function loadClarityScript(clarityId) {
    const f = document.getElementsByTagName('script')[0];
    const j = document.createElement('script');
    j.async = true;
    j.src = 'https://www.clarity.ms/tag/' + clarityId;
    f.parentNode.insertBefore(j, f);
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvY2xhcml0eS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQWdCLG9CQUFvQixFQUFDLE1BQU0sb0JBQW9CLENBQUM7QUFRdkUsSUFBSSxjQUFjLEdBQVksS0FBSyxDQUFDO0FBRXBDLE1BQU0sQ0FBQyxPQUFPLFVBQVUsV0FBVyxDQUFDLFNBQWlCLEVBQUUsV0FBMEI7SUFDN0UseUVBQXlFO0lBQ3pFLGNBQWMsR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDcEMsSUFBSSxDQUFDLGNBQWM7UUFBRSxPQUFPO0lBRTVCLE1BQU0sQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLE9BQU8sSUFBSTtRQUMvQixDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQTtJQUMvRCxDQUFDLENBQUE7SUFFRCxJQUFJLGVBQWUsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztJQUN0RSxJQUFJLFdBQVcsSUFBSSxvQkFBb0IsQ0FBQyxXQUFXLENBQUMsSUFBSSxXQUFXLENBQUMsU0FBUyxJQUFJLGVBQWUsRUFBRSxDQUFDO1FBQy9GLGFBQWEsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDekMsQ0FBQztJQUVELGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ2pDLENBQUM7QUFFRCxNQUFNLFVBQVUsYUFBYSxDQUFDLE9BQWdCO0lBQzFDLElBQUksQ0FBQyxjQUFjO1FBQUUsT0FBTztJQUM1QixNQUFNLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUN2QyxDQUFDO0FBRUQsU0FBUyxpQkFBaUIsQ0FBQyxTQUFTO0lBQ2hDLE1BQU0sQ0FBQyxHQUFHLFFBQVEsQ0FBQyxvQkFBb0IsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNyRCxNQUFNLENBQUMsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzNDLENBQUMsQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO0lBQ2YsQ0FBQyxDQUFDLEdBQUcsR0FBRyw2QkFBNkIsR0FBRyxTQUFTLENBQUM7SUFDbEQsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQ3BDLENBQUMiLCJmaWxlIjoiY29tcG9uZW50cy9jbGFyaXR5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDb25zZW50Q29va2llLCBpc1ZhbGlkQ29uc2VudENvb2tpZX0gZnJvbSBcIi4vY29va2llLWZ1bmN0aW9uc1wiO1xuXG5kZWNsYXJlIGdsb2JhbCB7XG4gICAgaW50ZXJmYWNlIFdpbmRvdyB7XG4gICAgICAgIGNsYXJpdHk6IGFueTtcbiAgICB9XG59XG5cbmxldCBjbGFyaXR5RW5hYmxlZDogYm9vbGVhbiA9IGZhbHNlO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpbml0Q2xhcml0eShjbGFyaXR5SWQ6IHN0cmluZywgdXNlckNvbnNlbnQ6IENvbnNlbnRDb29raWUpIHtcbiAgICAvLyBpZiB0aGUgZW52aXJvbm1lbnQgZG9lc24ndCBoYXZlIGEgbWVhc3VyZW1lbnQgaWQsIGRvbid0IGxvYWQgYW5hbHl0aWNzXG4gICAgY2xhcml0eUVuYWJsZWQgPSBCb29sZWFuKGNsYXJpdHlJZCk7XG4gICAgaWYgKCFjbGFyaXR5RW5hYmxlZCkgcmV0dXJuO1xuXG4gICAgd2luZG93LmNsYXJpdHkgPSB3aW5kb3cuY2xhcml0eSB8fCBmdW5jdGlvbigpIHtcbiAgICAgICAgKHdpbmRvdy5jbGFyaXR5LnEgPSB3aW5kb3cuY2xhcml0eS5xIHx8IFtdKS5wdXNoKGFyZ3VtZW50cylcbiAgICB9XG4gICAgXG4gICAgbGV0IHByZXZpb3VzQ29uc2VudCA9IEJvb2xlYW4od2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ19jbHRrJykpO1xuICAgIGlmICh1c2VyQ29uc2VudCAmJiBpc1ZhbGlkQ29uc2VudENvb2tpZSh1c2VyQ29uc2VudCkgJiYgdXNlckNvbnNlbnQuYW5hbHl0aWNzICE9IHByZXZpb3VzQ29uc2VudCkge1xuICAgICAgICB1cGRhdGVDb25zZW50KHVzZXJDb25zZW50LmFuYWx5dGljcyk7XG4gICAgfVxuXG4gICAgbG9hZENsYXJpdHlTY3JpcHQoY2xhcml0eUlkKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUNvbnNlbnQoY29uc2VudDogYm9vbGVhbikge1xuICAgIGlmICghY2xhcml0eUVuYWJsZWQpIHJldHVybjtcbiAgICB3aW5kb3cuY2xhcml0eSgnY29uc2VudCcsIGNvbnNlbnQpO1xufVxuXG5mdW5jdGlvbiBsb2FkQ2xhcml0eVNjcmlwdChjbGFyaXR5SWQpIHtcbiAgICBjb25zdCBmID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdO1xuICAgIGNvbnN0IGogPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICBqLmFzeW5jID0gdHJ1ZTtcbiAgICBqLnNyYyA9ICdodHRwczovL3d3dy5jbGFyaXR5Lm1zL3RhZy8nICsgY2xhcml0eUlkO1xuICAgIGYucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoaiwgZik7XG59XG4iXX0=
