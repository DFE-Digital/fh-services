# ADR027 - TITLE

- **Status**: Draft
- **Date**: 2025-02-19
- **Author**: Joshua Taylor MBCS

## Decision

<!-- 
    In a few sentences, describe the decision taken. 
-->

## Context

Part way through 2024, (??) made a feature request to provide end-user metric
and usage reports for the family hubs services (FOR WHO?).

These reports would need to contain, for example:

- the number of organisations recorded
- the number of services stored
- how many searches have been queried

These reports needed be accessible through the 'Manage' service by (???). An
approach for how the reports could be generated and how their underlying data
could be collected needed to be decided.

The approach needed to satisfy the (at the time) scalability requirements of
1000 concurrent users on the 'Find' and 'Connect' services. Accessing the
reports needed to also not exceed the performance requirement of under 3s to
process a request.

## Options considered

<!-- 
    Briefly describe each option considered as a numbered list. Start with the selected option.
    It's usually wise to include a 'do nothing' option.

    e.g.

    1. (SELECTED) PostgreSQL
    2. Oracle
    3. SQL Server  
-->

## Consequences

### Option 1 - Azure data factory ETL pipeline to generate service-fronted data warehouse

- Acessing metrics would be very performant.

- If high user load appears, there would be no degredation of performance.
  Scales well.

- Quite complex to implement, requires multiple new components which bring new
  maintenance and infrastructure costs.

- An Azure data factory (ADF) pipeline is hard to manage using infrastructure as
  code, increasing the overhead of creating new environments.

- Usage of a 'star schema' data warehouse would make any new metric requirements
  easy to provide, provided the right data is loaded.

### Option 2 - Directly query any service-related metrics

- No new components would be required, just added features to existing
  components.

- If user load grows, the execution time of queries would also grow. Could use
  caching to mitigate this.

- If new metrics are requested, modifications to various components may be
  required.

## Advice

<!--
    List of advice gathered to make this decision, including the names and role of 
    advisors and the date each piece of advice was gathered.

    Before submitting a decision, you are expected to gather advice from all team 
    members or stakeholders who will be affected by the decision.
-->